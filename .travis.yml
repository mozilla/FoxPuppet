language: python
python:
- 2.7
- 3.5

sudo: "required"

env:
  global:
    - DISPLAY=:99.0
matrix:
  include:
    - python: 2.7
      env: TOXENV=flake8
    - python: 2.7
      env: FIREFOX=nightly
      addons:
        firefox: latest-nightly
    - python: 2.7
      env: FIREFOX=dev
      addons:
        firefox: latest-dev
    - python: 2.7
      env: FIREFOX=beta
      addons:
        firefox: latest-beta
    - python: 2.7
      env: FIREFOX=release
      addons:
        firefox: latest
    - python: 2.7
      env: FIREFOX=esr
      addons:
        firefox: latest-esr
    - python: 3.5
      env: TOXENV=flake8
    - python: 3.5
      env: TOXENV=coverage
      addons:
        firefox: latest
    - python: 3.5
      env: FIREFOX=nightly
      addons:
        firefox: latest-nightly
    - python: 3.5
      env: FIREFOX=dev
      addons:
        firefox: latest-dev
    - python: 3.5
      env: FIREFOX=beta
      addons:
        firefox: latest-beta
    - python: 3.5
      env: FIREFOX=release
      addons:
        firefox: latest
    - python: 3.5
      env: FIREFOX=esr
      addons:
        firefox: latest-esr
  exclude:
    - python: 2.7
    - python: 3.5

before_install:
  - wget -O geckodriver.tar.gz https://github.com/mozilla/geckodriver/releases/download/v0.11.1/geckodriver-v0.11.1-linux64.tar.gz
  - gunzip -c geckodriver.tar.gz | tar xopf -
  - chmod +x geckodriver && sudo mv geckodriver /usr/local/bin
  - firefox --version
  - geckodriver --version

install:
  pip install tox-travis

notifications:
  webhooks:
    urls:
      - "https://silne30-foxpuppet.getbadges.io/api/app/webhook/b71ddba7-6feb-412c-8728-3efef552d02b"
    on_start: "change"

before_script:
  - sh -e /etc/init.d/xvfb start

script:
  - tox
